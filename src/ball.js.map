{"version":3,"sources":["ball_raw.js"],"names":["socket","io","ballpos","getBall","$","ajax","url","success","lat","loc","lng","lon","console","log","dataType","distance","lon1","lat1","lon2","lat2","R","dLat","toRad","dLon","a","Math","sin","cos","c","atan2","sqrt","d","clear","numberWithCommas","round","x","toString","replace","Number","prototype","PI","initMap","uluru","map","google","maps","Map","document","getElementById","zoom","center","gmarkers","addListener","event","pos","latLng","emit","removeMarkers","i","length","setMap","marker","Marker","position","icon","title","push","infowindow","InfoWindow","content","contentString","open","on","msg"],"mappings":"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","file":"ball.js","sourcesContent":["var socket = io();\n\nvar ballpos;\nfunction getBall(){\n  $.ajax({\n    url: '/api/getball',\n    success: function(success){\n      ballpos = {lat: success.loc.lat, lng: success.loc.lon};\n      console.log(ballpos);\n    },\n    dataType: 'json'\n  });\n}\ngetBall();\n\n// calc distance from ball\nfunction distance(lon1, lat1, lon2, lat2) {\n  var R = 6371; // Radius of the earth in km\n  var dLat = (lat2-lat1).toRad();  // Javascript functions in radians\n  var dLon = (lon2-lon1).toRad(); \n  var a = Math.sin(dLat/2) * Math.sin(dLat/2) +\n          Math.cos(lat1.toRad()) * Math.cos(lat2.toRad()) * \n          Math.sin(dLon/2) * Math.sin(dLon/2); \n  var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); \n  var d = R * c * 1000; // Distance in km\n  console.clear();\n  return numberWithCommas(Math.round(d)) + ' M';\n}\n\nfunction numberWithCommas(x) {\n    return x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n}\n\n/** Converts numeric degrees to radians */\nif (typeof(Number.prototype.toRad) === \"undefined\") {\n  Number.prototype.toRad = function() {\n    return this * Math.PI / 180;\n  }\n}\n\n      function initMap() {\n        var uluru = {lat: 41.77131167976406, lng: -1.40625};\n        var map = new google.maps.Map(document.getElementById('map'), {\n          zoom: 2,\n          center: uluru\n        });\n        var gmarkers = [];\n        // var marker = new google.maps.Marker({\n        //   position: uluru,\n        //   map: map\n        // });\n        map.addListener('click', function(event) {\n          var pos = {lat: event.latLng.lat(), lng: event.latLng.lng()};\n          socket.emit('chat message', 'click at ' + pos.lat + \", \" + pos.lng);\n          console.log(pos);\n          console.log(distance(event.latLng.lng(), event.latLng.lat(), ballpos.lng, ballpos.lat));\n          (function removeMarkers(){\n              for(i=0; i<gmarkers.length; i++){\n                  gmarkers[i].setMap(null);\n              }\n          })();\n          var marker = new google.maps.Marker({\n            position: pos,\n            map: map,\n            icon: 'rocket.png',\n            title: 'Uluru (Ayers Rock)'\n          });\n          gmarkers.push(marker);\n          var infowindow = new google.maps.InfoWindow({\n            content: contentString\n          });\n          \n          infowindow.open(map, marker);\n          \n        });\n        var contentString = '<div id=\"content\">HERE</div>';\n\n      }\n\n      socket.on('chat message', function(msg){\n        console.log(msg);\n      });"]}